<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Samples random draws from a generalised normal distribution using the Gibbs sampler by Waggoner &amp; Zha (2003a) — rgennorm • StealLikeBayes</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Samples random draws from a generalised normal distribution using the Gibbs sampler by Waggoner &amp; Zha (2003a) — rgennorm"><meta name="description" content="Samples random numbers from a generalised normal distribution
for a restricted \(N\times N\) full rank matrix \(X\). The matrix is drawn
row-by-row from their full conditional distributions using the Gibbs sampler
by Waggoner &amp;amp; Zha (2003a). The density is proportional to
$$det(X)^{\nu - N}\exp(-\frac{1}{2}\sum_{n=1}^{N}x_nV_nS_nV_n'x_n')$$
specified by the \(N\times N\) scale matrices \(S_n\), a positive
scalar-valued shape parameter \(\nu\), and \(r_n\times N\) selection
matrices \(V_n\) defining the restrictions. Zero restrictions may be
imposed on th \(X\) matrix row-by-row as
$$X_{n.} = x_nV_n$$
where \(1\times r_n\) vectors \(x_n\) collect the unrestricted elements
of \(X_{n.}\) and the matrices \(V_n\) place them in appropriate spots of the
\(1\times N\) row \(X_{n.}\). The output may be normalised using the
method by Waggoner &amp;amp; Zha (2003b) ensuring positive diagonal elements of the
output matrices.
This method is useful for sampling the structural matrix of the structural
vector autoregressive models identified by exclusion restrictions, sign and
exclusion restrictions, heteroskedasticity, and instrumental variables."><meta property="og:description" content="Samples random numbers from a generalised normal distribution
for a restricted \(N\times N\) full rank matrix \(X\). The matrix is drawn
row-by-row from their full conditional distributions using the Gibbs sampler
by Waggoner &amp;amp; Zha (2003a). The density is proportional to
$$det(X)^{\nu - N}\exp(-\frac{1}{2}\sum_{n=1}^{N}x_nV_nS_nV_n'x_n')$$
specified by the \(N\times N\) scale matrices \(S_n\), a positive
scalar-valued shape parameter \(\nu\), and \(r_n\times N\) selection
matrices \(V_n\) defining the restrictions. Zero restrictions may be
imposed on th \(X\) matrix row-by-row as
$$X_{n.} = x_nV_n$$
where \(1\times r_n\) vectors \(x_n\) collect the unrestricted elements
of \(X_{n.}\) and the matrices \(V_n\) place them in appropriate spots of the
\(1\times N\) row \(X_{n.}\). The output may be normalised using the
method by Waggoner &amp;amp; Zha (2003b) ensuring positive diagonal elements of the
output matrices.
This method is useful for sampling the structural matrix of the structural
vector autoregressive models identified by exclusion restrictions, sign and
exclusion restrictions, heteroskedasticity, and instrumental variables."><meta property="og:image" content="http://bsvars.org/StealLikeBayes/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StealLikeBayes</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"></ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Samples random draws from a generalised normal distribution using the Gibbs sampler by Waggoner &amp; Zha (2003a)</h1>

      <div class="d-none name"><code>rgennorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Samples random numbers from a generalised normal distribution
for a restricted \(N\times N\) full rank matrix \(X\). The matrix is drawn
row-by-row from their full conditional distributions using the Gibbs sampler
by Waggoner &amp; Zha (2003a). The density is proportional to
$$det(X)^{\nu - N}\exp(-\frac{1}{2}\sum_{n=1}^{N}x_nV_nS_nV_n'x_n')$$
specified by the \(N\times N\) scale matrices \(S_n\), a positive
scalar-valued shape parameter \(\nu\), and \(r_n\times N\) selection
matrices \(V_n\) defining the restrictions. Zero restrictions may be
imposed on th \(X\) matrix row-by-row as
$$X_{n.} = x_nV_n$$
where \(1\times r_n\) vectors \(x_n\) collect the unrestricted elements
of \(X_{n.}\) and the matrices \(V_n\) place them in appropriate spots of the
\(1\times N\) row \(X_{n.}\). The output may be normalised using the
method by Waggoner &amp; Zha (2003b) ensuring positive diagonal elements of the
output matrices.</p>
<p>This method is useful for sampling the structural matrix of the structural
vector autoregressive models identified by exclusion restrictions, sign and
exclusion restrictions, heteroskedasticity, and instrumental variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rgennorm</span><span class="op">(</span><span class="va">n</span>, <span class="va">X</span>, <span class="va">S</span>, <span class="va">nu</span>, <span class="va">V</span>, normalise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>a positive integer with the number of draws to be sampled.
<strong>C++</strong>: a <code>int</code> object.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an \(N\times N\) structural matrix with the starting values to
initiate the Gibbs sampler. <strong>C++</strong>: an <code>arma::mat</code> matrix object.</p></dd>


<dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>an \(N\times N\times N\) array with \(N\times N\) row-specific
precision matrices \(S_n\). <strong>C++</strong>: an <code>arma::cube</code> object.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>a positive integer number with the shape parameter \(nu\).
<strong>C++</strong>: an <code>arma::int</code> object.</p></dd>


<dt id="arg-v">V<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>a list with \(N\) elements each including \(r_n\times N\)
matrices \(V_n\). <strong>C++</strong>: an <code>arma::field&lt;arma::mat&gt;</code> object.</p></dd>


<dt id="arg-normalise">normalise<a class="anchor" aria-label="anchor" href="#arg-normalise"></a></dt>
<dd><p>a logical value of whether the output should be normalised
following the method by Waggoner &amp; Zha (2003b) ensuring positive signs of the
diagonal elements of the sampled matrices. <strong>C++</strong>: an <code>bool</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an \(N\times N\times n\)-array with random draws from the
generalised normal distribution. <strong>C++</strong>: an <code>arma::cube</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is based on C++ code from the R package <span class="pkg">bsvars</span>
by Woźniak (2024,2025) and is using
objects and commands from the <span class="pkg">armadillo</span> library by Sanderson &amp; Curtin (2025)
thanks to the <span class="pkg">RcppArmadillo</span> package by Eddelbuettel, Francois, Bates,
Ni, &amp; Sanderson (2025).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Eddelbuettel D., Francois R., Bates D., Ni B., Sanderson C. (2025).
RcppArmadillo: 'Rcpp' Integration for the 'Armadillo' Templated Linear
Algebra Library. R package version 15.0.2-2. &lt;doi:10.32614/CRAN.package.RcppArmadillo&gt;</p>
<p>Sanderson C., Curtin R. (2025). Armadillo: An Efficient Framework for
Numerical Linear Algebra. International Conference on Computer and Automation
Engineering, 303-307, &lt;doi:10.1109/ICCAE64891.2025.10980539&gt;</p>
<p>Waggoner D.F., Zha T., (2003a). A Gibbs Sampler for Structural Vector
Autoregressions. Journal of Economic Dynamics and Control, 28(2), 349-366,
&lt;doi:10.1016/S0165-1889(02)00168-9&gt;.</p>
<p>Waggoner, D.F., Zha, T. (2003b). Likelihood Preserving Normalization in
Multiple Equation Models. Journal of Econometrics, 114(2), 329-347.
&lt;doi:10.1016/S0304-4076(03)00087-3&gt;</p>
<p>Woźniak T. (2024). bsvars: Bayesian Estimation of Structural Vector
Autoregressive Models, R package version 3.2,
&lt;doi:10.32614/CRAN.package.bsvars&gt;.</p>
<p>Woźniak T. (2025). Fast and Efficient Bayesian Analysis of Structural Vector
Autoregressions Using the R Package bsvars. University of Melbourne Working
Paper, 1–25. &lt;doi:10.48550/arXiv.2410.15090&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tomasz Woźniak <a href="mailto:wozniak.tom@pm.me">wozniak.tom@pm.me</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">rgennorm</span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.1593962 -3.2777784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.9654515  0.9654515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Woźniak, Xiaolei Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

